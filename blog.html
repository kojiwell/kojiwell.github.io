<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Blog | kojiwell</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kojiwell.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kojiwell.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kojiwell.github.io/blog"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog | kojiwell"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kojiwell.github.io/blog"><link data-rh="true" rel="alternate" href="https://kojiwell.github.io/blog" hreflang="en"><link data-rh="true" rel="alternate" href="https://kojiwell.github.io/blog" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="kojiwell RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="kojiwell Atom Feed"><link rel="stylesheet" href="/assets/css/styles.c293d817.css">
<script src="/assets/js/runtime~main.5b4fe15a.js" defer="defer"></script>
<script src="/assets/js/main.e5a7c851.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/campfire.svg" alt="kojiwell logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/campfire.svg" alt="kojiwell logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kojiwell</b></a><a class="navbar__item navbar__link" href="/docs/notes">Notes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023-05-13-bits-and-pieces">2023-05-13 Bits and pieces here and there</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023-04-28-bits-and-pieces">2023-04-28 Bits and pieces here and there</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2018-02-27-lustre-on-centos72">Install Lustre on Multiple CentOS 7 Machines</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Sorites Paradox"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2023-05-13-bits-and-pieces">2023-05-13 Bits and pieces here and there</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-05-13T00:00:00.000Z" itemprop="datePublished">May 13, 2023</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/kojiwell" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/kojiwell.png" alt="Koji Tanaka" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/kojiwell" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Koji Tanaka</span></a></div><small class="avatar__subtitle" itemprop="description">System Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sorites-paradox">Sorites Paradox<a href="#sorites-paradox" class="hash-link" aria-label="Direct link to Sorites Paradox" title="Direct link to Sorites Paradox">​</a></h2>
<p>The word &quot;supercomputer&quot; is vague, like a heap of sand in Sorites Paradox.</p>
<p>A couple of hardware failure is not a big deal. A supercomputer is still a supercomputer.
And, even if one-third of compute nodes were shut down because of the escalating energy cost,
it would still be a supercomputer. What about losing half of the capacity?
Where is the borderline between a supercomputer and a non-supercomputer?</p>
<p>Wikipedia: <a href="https://en.wikipedia.org/wiki/Sorites_paradox" target="_blank" rel="noopener noreferrer">Sorites Paradox</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="kanizsa-triangle">Kanizsa triangle<a href="#kanizsa-triangle" class="hash-link" aria-label="Direct link to Kanizsa triangle" title="Direct link to Kanizsa triangle">​</a></h2>
<p>Sometimes, what we see or perceive in life is not actually what is there.</p>
<p>The Kanizsa triangle is a classic optical illusion that consists of three
pac-man-like shapes arranged in a triangle. Even though there isn&#x27;t a triangle,
our brain thinks there is.</p>
<p>Wikipedia: <a href="https://en.wikipedia.org/wiki/Illusory_contours" target="_blank" rel="noopener noreferrer">Illusory contours</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="nelson-molina">Nelson Molina<a href="#nelson-molina" class="hash-link" aria-label="Direct link to Nelson Molina" title="Direct link to Nelson Molina">​</a></h2>
<p>Finding joy in day-to-day tasks would be more important than the technical skills on the resume.
I found an interesting story about Nelson Molina, who worked as a sanitation worker for over
30 years in New York City.</p>
<p><em>&quot;<a href="https://money.cnn.com/2017/07/06/news/economy/new-york-city-trash-museum-nelson-molina/index.html" target="_blank" rel="noopener noreferrer">Nelson Molina spent 34 years as a garbage man in New York City</a>.
He salvaged over 50,000 items from the garbage and put them
on display in what he calls a &quot;secret museum&quot; in Manhattan.
He hopes the city will turn it into a real museum soon.&quot; -- CNN</em></p>
<p>Also, this YouTube video &quot;<a href="https://youtu.be/NO4ZQbsZFK8" target="_blank" rel="noopener noreferrer">Treasures in the Trash</a>&quot;
from the <a href="https://www.60secdocs.com/" target="_blank" rel="noopener noreferrer">60 Second Docs</a> is wonderful.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="capoeira">Capoeira<a href="#capoeira" class="hash-link" aria-label="Direct link to Capoeira" title="Direct link to Capoeira">​</a></h2>
<p>A few days ago, on a weekend, I was hanging out with my two kids around
the village office, and there was a small group of people practicing Capoeira
on the stage in the courtyard. They were playing unique instruments, singing,
and dancing, but at the same time, simulating fights, which was eye-grabbing.</p>
<p>There was no audience except us(my kids and me), and we enjoyed watching it.
I thought that the two elements(dance and martial art) are very different and
combining these two have lead to a unique and innovative creation that naturally
gets people together.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="frc">FRC<a href="#frc" class="hash-link" aria-label="Direct link to FRC" title="Direct link to FRC">​</a></h2>
<p>The term &quot;FRC&quot; in freediving stands for &quot;functional residual capacity,&quot; which
refers to the volume of air that remains in the lungs after a normal exhalation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="python">python<a href="#python" class="hash-link" aria-label="Direct link to python" title="Direct link to python">​</a></h2>
<p>Python&#x27;s <code>enumerate()</code> object is returned in a key-value pair format. The key is
the corresponding index of each item and the value is the items.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> my_array </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;dog&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;cat&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;fox&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">my_array</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;dog&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;cat&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;fox&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">my_array</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">     </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">str</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">n</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> : </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">item</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> fox</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A binary number starts with <code>0b</code> and a hex number starts with <code>0x</code>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">bin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">28</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># decimal to binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;0b11100&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">28</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># decimal to hex(hexadecimal)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;0x1c&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;0b11100&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># binary to decimal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">28</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;0x1c&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># hex to decimal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">28</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tar">tar<a href="#tar" class="hash-link" aria-label="Direct link to tar" title="Direct link to tar">​</a></h2>
<p>Extract a specific file from a tar.gz file</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Print the list of the files in the tar.gz and find the path of the file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar ztf data_a.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Extract the file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar zxvf data_a.tar.gz data_a/datetime/data-1/data-1-a-b.tif</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Extract the directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar zxvf data_a.tar.gz data_a/datetime/data-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -x: instructs tar to extract files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -f: specifies filename / tarball name.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -v: Verbose (show progress while extracting files).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -z: filter archive through gzip, use to decompress .gz files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -t: List the contents of an archive</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="awk">awk<a href="#awk" class="hash-link" aria-label="Direct link to awk" title="Direct link to awk">​</a></h2>
<p>Print a matched line with a specific delimiter (e.g. <code>,</code>)</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Check out the matched line</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grep comp01-mg /etc/hosts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.1.101    comp01-mg.mydomain.com    comp01-mg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Print the line as &quot;ip,hostname,hostname.domain&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">awk &#x27;/comp01-mg/ {print $1,$3,$2}&#x27; OFS=&quot;,&quot; /etc/hosts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.1.101,comp01-mg,comp01-mg.mydomain.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="idrac">iDRAC<a href="#idrac" class="hash-link" aria-label="Direct link to iDRAC" title="Direct link to iDRAC">​</a></h2>
<p><em>&quot;Access Error: 400 -- Bad Request.&quot;</em></p>
<p>Sometimes, iDRAC webui beomes inaccessible with FQDN, showing this error message,
&quot;Access Error: 400 -- Bad Request.&quot; It seems like a bug in a particular iDRAC version.
Here&#x27;s the workaround, which lets you manually set its FQDN.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">racadm set idrac.webserver.ManualDNSentry \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  192.168.20.30,hostname-mg,hostname-mg.mydomain.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># using the awk tip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">racadm set idrac.webserver.ManualDNSentry \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $(awk &#x27;/comp01-mg/ {print $1,$3,$2}&#x27; OFS=&quot;,&quot; /etc/hosts)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/misc">misc</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Les Davis"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2023-04-28-bits-and-pieces">2023-04-28 Bits and pieces here and there</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-04-28T00:00:00.000Z" itemprop="datePublished">April 28, 2023</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/kojiwell" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/kojiwell.png" alt="Koji Tanaka" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/kojiwell" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Koji Tanaka</span></a></div><small class="avatar__subtitle" itemprop="description">System Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="les-davis">Les Davis<a href="#les-davis" class="hash-link" aria-label="Direct link to Les Davis" title="Direct link to Les Davis">​</a></h2>
<p>&quot;Seymour thought them up, and Les made them work,&quot; said former Cray CEO Rollwagen.</p>
<p>Seymour Cray is the pioneer, the genius, and the name of Cray Research, Inc. However, the engineer who has guided the company to keep producing successful supercomputers for years in the risky high-tech industry is Les Davis. He is the ultimate team builder who knows how to bring all the talent together to create excellent supercomputers.</p>
<p>Open <a href="https://cray-history.net/wp-content/uploads/2021/08/TheUltimateTeamPlayerLesDavid.pdf" target="_blank" rel="noopener noreferrer">this link for more about the interesting supercomputer history (PDF)</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="potato-vs-sweet-potato">Potato vs sweet potato<a href="#potato-vs-sweet-potato" class="hash-link" aria-label="Direct link to Potato vs sweet potato" title="Direct link to Potato vs sweet potato">​</a></h2>
<p>Potato is a stem, and sweet potato is a root. Potato has eyes which develop into shoots. So potato has to produce poison in itself to protect shoots from bugs, while sweet potato doesn&#x27;t have to.</p>
<p>I see it as a good analogy for career development. If you want to go up the ladder of success, you must develop poison in yourself to protect yourself. If you want to dig deep down into the technical adventure, it&#x27;s dark and sweet.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dsmc">dsmc<a href="#dsmc" class="hash-link" aria-label="Direct link to dsmc" title="Direct link to dsmc">​</a></h2>
<p>Restore a directory from the backup data on the TSM</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Check if the directory is in the backup data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsmc query backup /path/to/dir_a/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Restore the directory to the current directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsmc restore -inactive -subdir=yes /path/to/dir_a/ $PWD/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check the restored directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tree $PWD/dir_a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="find">find<a href="#find" class="hash-link" aria-label="Direct link to find" title="Direct link to find">​</a></h2>
<p>Search a file by a case-insensitive keyword</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">find /path/to/dir -type f -iname &quot;*keyword*&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="git">git<a href="#git" class="hash-link" aria-label="Direct link to git" title="Direct link to git">​</a></h2>
<p>Set a different ssh private key for git</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># In the config of the current git repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git config core.sshCommand &quot;ssh -i /path/to/new-key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat .git/config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># By the encironment variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GIT_SSH_COMMAND=&quot;ssh -i /path/to/new-key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rsync">rsync<a href="#rsync" class="hash-link" aria-label="Direct link to rsync" title="Direct link to rsync">​</a></h2>
<p>Check differences between two directories by the <code>--dry-run, -n</code> option</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rsync -av --dry-run /path/to/dir_a/ /path/to/dir_b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -n is the same (if you got used to the short expression)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rsync -avn /path/to/dir_a/ /path/to/dir_b</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sed">sed<a href="#sed" class="hash-link" aria-label="Direct link to sed" title="Direct link to sed">​</a></h2>
<p>Remove the last comma(,) from &quot;host01,host04,host07,&quot;</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;host01,host04,host07,&quot; |sed &#x27;s/.$//&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sinfo">sinfo<a href="#sinfo" class="hash-link" aria-label="Direct link to sinfo" title="Direct link to sinfo">​</a></h2>
<p>List the down and drained nodes</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sinfo  -h -t down,drained -o &quot;%n %E&quot; |sort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -h, --noheader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -t, --states</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -o, --format</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Create the list of drained nodes because of either &quot;Kill task failed&quot; or &quot;batch job complete failure&quot;</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sinfo -h -t drained -o &quot;%n %E&quot; |sort |awk &#x27;/Kill task|batch job/ {print $1}&#x27; ORS=&quot;,&quot; |sed &#x27;s/.$//&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/misc">misc</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Lustre is a parallel distributed file system that&#x27;s often used in supercomputers. It&#x27;s a high performance file system, highly scalable, and free -- available under an open source license called GPL v2. If you&#x27;re interested in supercomputers, Lustre will be one of the things you&#x27;d want to put together."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2018-02-27-lustre-on-centos72">Install Lustre on Multiple CentOS 7 Machines</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2018-02-27T00:00:00.000Z" itemprop="datePublished">February 27, 2018</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/kojiwell" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/kojiwell.png" alt="Koji Tanaka" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/kojiwell" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Koji Tanaka</span></a></div><small class="avatar__subtitle" itemprop="description">System Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><a href="http://lustre.org/" target="_blank" rel="noopener noreferrer">Lustre</a> is a parallel distributed file system that&#x27;s often used in supercomputers. It&#x27;s a high performance file system, highly scalable, and free -- available under an open source license called <a href="https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html" target="_blank" rel="noopener noreferrer">GPL v2</a>. If you&#x27;re interested in supercomputers, Lustre will be one of the things you&#x27;d want to put together.</p>
<p>On this post, I&#x27;m going to write about how to install Lustre, using six CentOS 7 instances on AWS. This is not about testing Lustre&#x27;s performance but about understanding the structure of Lustre by actually installing it, so AWS is a convenient platform to do that.</p>
<p>Here, I try my best to explain the Lustre structure with my testing setup. So look at the network diagram below.</p>
<p><img decoding="async" loading="lazy" alt="Drawing" src="/assets/images/lustre_architecture-2843324b7765a9795d4c28d5c21127ef.svg" width="610" height="450" class="img_ev3q"></p>
<p>Lustre file system is composed of three types of servers -- MGS(Management Server), MDS(Metadata Server) and OSS(Object Storage Server).</p>
<p>First, look at the MGS. The MGS provides configuration informantion and status updates of all the other servers to all the clients and servers. Those pieces of information and logs are stored in MGT(Management Terget). I will create the MGT on <code>/dev/xvdb</code> of the MGS.</p>
<p>Next is the MDS. It provides the index(or namespace) for the Lustre file system. The file metadata -- such as directory structures and file names, permissions and layouts -- are recorded on the MDT(Metadata Terget). In the example, the MDT is made on <code>/dev/xvdb</code> of the MDS.</p>
<p>Then, look at the OSS 1, OSS 2 and OSS 3. They are Object Storage Servers, which provide the data storage for all file contents. Those data are stored on OSTs(Object Storage Tergets) -- <code>/dev/xvdb</code> and <code>/dev/xvdc</code> on the OSSs in my example.</p>
<p>The Client mounts the Lustre file system on a directory -- <code>/lustrefs</code> in this example -- and uses it like a NFS mounted directory that has high-performance capabilities. In a supercomputer, there are usually a lot of compute nodes -- the hosts on the internal network of a supercomputer are referred to as &quot;nodes&quot;, and those nodes become Lustre clients. I have only one client in my example just because I want to simplify the process. So imagine there are a lot of client nodes in a real-world Lustre setup.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="build-the-base-part-of-all-nodes">Build The Base Part of All Nodes<a href="#build-the-base-part-of-all-nodes" class="hash-link" aria-label="Direct link to Build The Base Part of All Nodes" title="Direct link to Build The Base Part of All Nodes">​</a></h2>
<p>As I previously explained, hosts in the internal network of a supercomputer are called as &quot;nodes&quot;, so I call hosts nodes. Also, to simplify the process, I assume every step is done by <code>root</code> account.</p>
<p>To start the installation, add these nodes on <code>/etc/hosts</code> of all nodes. The node names are all lower-case letters with no space, and the <code>/etc/hosts</code> looks like this:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1   localhost localhost.localdomain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">172.31.47.35   client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">172.31.44.215  mgs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">172.31.44.227  mds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">172.31.39.125  oss1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">172.31.32.6    oss2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">172.31.44.150  oss3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>NOTE: You have to update <code>/etc/hosts</code> of all the nodes.</p>
<p>Next, install EPEL and ZFS repositories, and also install <a href="https://chrony.tuxfamily.org/" target="_blank" rel="noopener noreferrer">Chrony</a>. (Chrony is a NTP implementation. You can also use <code>ntp</code> instead.):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install epel-release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rpm -ivh http://download.zfsonlinux.org/epel/zfs-release.el7.centos.noarch.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install chrony</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start chronyd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl enable chronyd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>NOTE: It is important to have the correct time on all nodes.</p>
<p>Set the timezone if needed. It&#x27;s <code>Asia/Tokyo</code> in my case, and you can set it by <code>timedatectl</code> command like this:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">timedatectl set-timezone Asia/Tokyo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Create the Lustre repository configuration file <code>/etc/yum.repos.d/lustre.repo</code> and put the follows in it:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[lustre-server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name=CentOS-$releasever - Lustre</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">baseurl=https://downloads.hpdd.intel.com/public/lustre/latest-feature-release/el7/server/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpgcheck=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[e2fsprogs]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name=CentOS-$releasever - Ldiskfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">baseurl=https://downloads.hpdd.intel.com/public/e2fsprogs/latest/el7/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpgcheck=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[lustre-client]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name=CentOS-$releasever - Lustre</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">baseurl=https://downloads.hpdd.intel.com/public/lustre/latest-feature-release/el7/client/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpgcheck=0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Install the latest Lustre-enabled kernel and the Lustre client on all nodes:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install e2fsprogs \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lustre-client \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kernel-3.10.0-514.21.1.el7_lustre.x86_64 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kernel-devel-3.10.0-514.21.1.el7_lustre.x86_64 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kernel-headers-3.10.0-514.21.1.el7_lustre.x86_64</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now you need to <strong>reboot all the nodes</strong> to boot the nodes with the Lustre-enabled kernel.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-lnet-module-on-serversmgs-mds-and-osss">Setup LNET Module on Servers(MGS, MDS and OSSs)<a href="#setup-lnet-module-on-serversmgs-mds-and-osss" class="hash-link" aria-label="Direct link to Setup LNET Module on Servers(MGS, MDS and OSSs)" title="Direct link to Setup LNET Module on Servers(MGS, MDS and OSSs)">​</a></h2>
<p>Create a modeprobe configuration file for the LNet -- <code>/etc/modprobe.d/lnet.conf</code> -- and set
the <code>networks</code> parameter as <code>tcp0(eth0)</code>. Basically, you just need this one line on the file:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">options lnet networks=tcp0(eth0)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>LNet is Lustre&#x27;s network communicatoin protocol. The option <code>networks=tcp0(eth0)</code> means that the
node belongs to the LNet named <code>tcp0</code> using the network interface <code>eth0</code>.</p>
<p>Load the LNET module manually with <code>modprobe</code> command like this:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">modprobe lnet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Make sure the LNET module is loaded:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lsmod | grep lnet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To automatically load the LNet modules at boot, create
<code>/etc/sysconfig/modules/lnet.modules</code> and put the following script in the file:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ ! -c /dev/lnet ] ; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exec /sbin/modprobe lnet &gt;/dev/null 2&gt;&amp;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-lustre-module-on-client">Setup Lustre Module on Client<a href="#setup-lustre-module-on-client" class="hash-link" aria-label="Direct link to Setup Lustre Module on Client" title="Direct link to Setup Lustre Module on Client">​</a></h2>
<p>Load the Lustre module
with <code>modprobe</code> command like this:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">modprobe lustre</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Check if the Lustre module is loaded:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lsmod | grep lustre</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To automatically load the Lustre module at boot, create <code>/etc/sysconfig/modules/lustre.modules</code>
with the script below:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/sbin/lsmod | /bin/grep lustre 1&gt;/dev/null 2&gt;&amp;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ ! $? ] ; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /sbin/modprobe lustre &gt;/dev/null 2&gt;&amp;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now you&#x27;re ready to create a Lustre file system.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-lustre-file-system">Create Lustre File System<a href="#create-lustre-file-system" class="hash-link" aria-label="Direct link to Create Lustre File System" title="Direct link to Create Lustre File System">​</a></h2>
<p>Now your nodes are ready to create a Lustre file system.</p>
<p><strong>Create MGT on MGS:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@mgs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.lustre --mgs /dev/xvdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /mgt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount.lustre /dev/xvdb /mgt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Create MDT on MDS:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@mds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.lustre --fsname=lustrefs --mgsnode=mgs@tcp0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --mdt --index=0 /dev/xvdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /mdt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount.lustre /dev/xvdb /mdt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Create OST 1 and OST 2 on OSS 1:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@oss1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.lustre --ost --fsname=lustrefs --mgsnode=mgs@tcp0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --index=1 /dev/xvdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.lustre --ost --fsname=lustrefs --mgsnode=mgs@tcp0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --index=2 /dev/xvdc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /ost1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /ost2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount.lustre /dev/xvdb /ost1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount.lustre /dev/xvdc /ost2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Create OST 3 and OST 4 on OSS 2:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@oss2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.lustre --ost --fsname=lustrefs --mgsnode=mgs@tcp0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --index=3 /dev/xvdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.lustre --ost --fsname=lustrefs --mgsnode=mgs@tcp0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --index=4 /dev/xvdc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /ost3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /ost4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount.lustre /dev/xvdb /ost3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount.lustre /dev/xvdc /ost4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Create OST 5 and OST 6 on OSS 3:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@oss3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.lustre --ost --fsname=lustrefs --mgsnode=mgs@tcp0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --index=5 /dev/xvdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.lustre --ost --fsname=lustrefs --mgsnode=mgs@tcp0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --index=6 /dev/xvdc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /ost5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /ost6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount.lustre /dev/xvdb /ost5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount.lustre /dev/xvdc /ost6</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Mount Lustre file system on Client</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /lustrefs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount -t lustre mgs@tcp0:/lustrefs /lustrefs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="check-the-file-system">Check the file system<a href="#check-the-file-system" class="hash-link" aria-label="Direct link to Check the file system" title="Direct link to Check the file system">​</a></h2>
<p>From the client node, you can check the status with <code>lfs</code> command.</p>
<p>Check /lustrefs:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df -h /lustrefs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Filesystem                   Size  Used Avail Use% Mounted on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">172.31.42.130@tcp:/lustrefs   56G  223M   53G   1% /lustrefs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Check servers:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lfs check servers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-MDT0000-mdc-ffff88003bfbd000 active.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0001-osc-ffff88003bfbd000 active.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0002-osc-ffff88003bfbd000 active.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0003-osc-ffff88003bfbd000 active.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0004-osc-ffff88003bfbd000 active.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0005-osc-ffff88003bfbd000 active.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0006-osc-ffff88003bfbd000 active.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Check the file system:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lfs df -h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UUID                       bytes        Used   Available Use% Mounted on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-MDT0000_UUID        5.6G       45.8M        5.0G   1% /lustrefs[MDT:0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0001_UUID        9.2G       37.1M        8.7G   0% /lustrefs[OST:1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0002_UUID        9.2G       37.1M        8.7G   0% /lustrefs[OST:2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0003_UUID        9.2G       37.1M        8.7G   0% /lustrefs[OST:3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0004_UUID        9.2G       37.1M        8.7G   0% /lustrefs[OST:4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0005_UUID        9.2G       37.1M        8.7G   0% /lustrefs[OST:5]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0006_UUID        9.2G       37.1M        8.7G   0% /lustrefs[OST:6]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filesystem_summary:        55.3G      222.9M       52.0G   0% /lustrefs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the outputs look good, you&#x27;re good to go for testing Lustre. Here&#x27;s a quick test:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@client ~]# for aa in {1..5}; do dd if=/dev/zero of=/lustrefs/file$aa bs=4k iflag=fullblock,count_bytes count=1G; done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@client ~]# df -h /lustrefs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Filesystem                   Size  Used Avail Use% Mounted on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">172.31.42.130@tcp:/lustrefs   56G  5.3G   47G  10% /lustrefs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@client ~]# lfs df -h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UUID                       bytes        Used   Available Use% Mounted on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-MDT0000_UUID        5.6G       45.8M        5.0G   1% /lustrefs[MDT:0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0001_UUID        9.2G        1.0G        7.7G  12% /lustrefs[OST:1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0002_UUID        9.2G       37.1M        8.7G   0% /lustrefs[OST:2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0003_UUID        9.2G        2.0G        6.6G  23% /lustrefs[OST:3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0004_UUID        9.2G        1.0G        7.7G  12% /lustrefs[OST:4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0005_UUID        9.2G       37.1M        8.7G   0% /lustrefs[OST:5]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lustrefs-OST0006_UUID        9.2G        1.0G        7.6G  12% /lustrefs[OST:6]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sidenotes">Sidenotes<a href="#sidenotes" class="hash-link" aria-label="Direct link to Sidenotes" title="Direct link to Sidenotes">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="build-and-install-lustre-from-source-code">Build and Install Lustre from Source Code<a href="#build-and-install-lustre-from-source-code" class="hash-link" aria-label="Direct link to Build and Install Lustre from Source Code" title="Direct link to Build and Install Lustre from Source Code">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sed -i &#x27;/^SELINUX=/s/.*/SELINUX=disabled/&#x27; /etc/selinux/config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum groupinstall &quot;Development tools&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install epel-release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install xmlto asciidoc elfutils-libelf-devel zlib-devel \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       libyaml-devel kernel-devel binutils-devel newt-devel \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       python-devel hmaccalc perl-ExtUtils-Embed bison \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       elfutils-devel audit-libs-devel python-docutils \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       sg3_utils expect attr lsof quilt libselinux-devel \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       e2fsprogs e2fsprogs-devel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install --enablerepo=base-debuginfo kernel-debuginfo kernel-debuginfo-common</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone git://git.hpdd.intel.com/fs/lustre-release.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd lustre-release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sh ./autogen.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./configure --with-linux=/usr/src/kernels/$(uname -r)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make rpms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install *.$(arch).rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reboot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="infiniband">Infiniband<a href="#infiniband" class="hash-link" aria-label="Direct link to Infiniband" title="Direct link to Infiniband">​</a></h4>
<p>When you use InfiniBand, <code>/etc/modprobe.d/lnet.conf</code> should be like below. The
<code>ib0</code> in the config is the ib interface you want to use.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">options lnet networks=o2ib0(ib0)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="raid">RAID<a href="#raid" class="hash-link" aria-label="Direct link to RAID" title="Direct link to RAID">​</a></h4>
<p>I used block devices for MGT, MDT and OSTs in the example, but in a production
setup, you need to have those on RAID because you don&#x27;t want to cause data loss.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="hahigh-availability-for-mgs-and-mds">HA(High Availability) for MGS and MDS<a href="#hahigh-availability-for-mgs-and-mds" class="hash-link" aria-label="Direct link to HA(High Availability) for MGS and MDS" title="Direct link to HA(High Availability) for MGS and MDS">​</a></h4>
<p>The MGS and MDS are so important. So making an extra effort to setup HA is required
for a production.</p>
<ul>
<li><a href="https://docs.linbit.com/" target="_blank" rel="noopener noreferrer">DRBD</a> - RAID1 over network</li>
<li><a href="http://linux-ha.org/wiki/Heartbeat" target="_blank" rel="noopener noreferrer">Heartbeat</a> or <a href="https://github.com/ClusterLabs/pacemaker" target="_blank" rel="noopener noreferrer">Pacemaker</a> - Controls and checks communication between two nodes</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="lustre-tuning">Lustre Tuning<a href="#lustre-tuning" class="hash-link" aria-label="Direct link to Lustre Tuning" title="Direct link to Lustre Tuning">​</a></h4>
<p>Many options in Lustre are set as kernel module parameters. Go check out
this link -- <a href="http://wiki.lustre.org/Lustre_Tuning" target="_blank" rel="noopener noreferrer">Lustre Tuning</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2>
<ul>
<li><a href="http://lustre.org/getting-started-with-lustre/" target="_blank" rel="noopener noreferrer">Getting Started With lustre</a></li>
<li><a href="http://wiki.lustre.org/Main_Page" target="_blank" rel="noopener noreferrer">wiki.lustre.org</a></li>
<li><a href="https://gist.github.com/joshuar/4e283308c932ec62fc05" target="_blank" rel="noopener noreferrer">Quick three-node Lustre set-up on CentOS 6</a></li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/centos">centos</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/lustre">lustre</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/notes">Notes</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/kojiwell" target="_blank" rel="noopener noreferrer" class="footer__link-item">X (Twitter)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://qiita.com/kojiwell" target="_blank" rel="noopener noreferrer" class="footer__link-item">Qiita (Japanese)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kojiwell" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Koji Tanaka</div></div></div></footer></div>
</body>
</html>